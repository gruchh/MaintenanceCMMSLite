# CMMS Lite 🚧

A lightweight Computerized Maintenance Management System (CMMS) designed to streamline maintenance operations. The backend is built with Spring Boot, utilizing Spring Data JPA, Spring Security, and JWT for authentication. The frontend is developed using Angular with Tailwind CSS for styling. The application is containerized and orchestrated using Docker for easy deployment and scalability.

## ✨ Features

-   🛠️ **Comprehensive Maintenance Management**:
    -   **Work Orders**: Report, track, and manage the entire lifecycle of machinery breakdowns, from initial report to resolution.
    -   **Asset Management**: Full CRUD (Create, Read, Update, Delete) for machines and equipment.
    -   **Personnel Management**: Manage detailed employee profiles, roles (e.g., *Mechanic, Manager*), contact information, and professional details.
    -   **Inventory Control**: Full CRUD for spare parts. Automatically logs parts used for repairs and calculates total breakdown cost.
    -   **Shift Scheduling**: Generate and manage multi-brigade work schedules for maintenance teams.
-   📊 **Performance Analytics**: API endpoints for key performance indicators, including breakdown statistics and weekly performance reports.
-   📖 **API Documentation**: Automatically generated and interactive API documentation with SpringDoc OpenAPI.
-   🔒 **Secure Authentication & Authorization**:
    -   Implements JWT-based authentication with Spring Security.
    -   Features Role-Based Access Control (RBAC) with distinct roles (`ADMIN`, `TECHNICAN`, `SUBCONTRACTOR`) protecting API endpoints.
-   📱 **Responsive UI**: Built with Angular and styled using Tailwind CSS for a modern, responsive interface.
-   🗄️ **Database Support**: Supports both H2 (for development) and PostgreSQL (for production), with database migrations managed by Flyway.
-   🌱 **Sample Data Seeding**: Includes a `DataInitializer` for the `dev` profile that uses JavaFaker to populate the database with realistic sample data for a rich development experience.
-   ⚙️ **Robust Error Handling**: Centralized exception handling provides consistent and meaningful API error responses.
-   🐳 **Containerized Deployment**: Uses Docker and Docker Compose for simplified setup and deployment.

## 🏛️ Architecture Overview

### Backend Architecture

The backend follows a modular, feature-oriented architecture. Each core domain has its own dedicated package containing its entities, repositories, services, and controllers.

```
com.cmms.lite
├── CmmsLiteApplication.java
├── breakdown         # Core logic for breakdowns; links machines, employees, and parts.
├── breakdownType     # Defines breakdown categories (e.g., MECHANICAL, AUTOMATICAL).
├── config            # Application configuration, including the dev data initializer.
├── employee          # Manages employee data, details, and profiles.
├── employeeRole      # Defines employee roles (e.g., Mechanic, Automation Engineer).
├── exception         # Global exception handling and custom exceptions.
├── machine           # Manages machine and equipment data.
├── security          # Handles JWT authentication, user management, and authorization.
├── shiftSchedule     # Logic for generating and managing team work schedules.
└── sparePart         # Manages the spare parts inventory.
```

### Frontend Architecture

The frontend is built using Angular and follows a scalable, modular architecture that separates concerns into four main categories: `core`, `features`, `layout`, and `shared`.

```
/src/app
├── core/           # Core services, guards, and interceptors. Singleton logic.
│   ├── api/        # Generated API client and related models.
│   ├── guards/     # Route guards for authentication and authorization.
│   └── interceptors/ # HTTP interceptors (e.g., for adding JWT tokens).
│
├── features/       # Individual application features or business modules.
│   ├── dashboard/  # Main dashboard with sub-modules (overview, employees, etc.).
│   └── home/       # The public-facing home page.
│
├── layout/         # Reusable layout components (e.g., navbars, sidebars).
│   ├── dashboard-layout/ # Layout for the authenticated user area.
│   └── default-layout/   # Layout for public pages.
│
└── shared/         # Reusable components, pipes, and directives.
    └── components/ # Shared UI components (modals, buttons, etc.).
```

-   **Core**: Contains singleton services, interceptors, and guards that are loaded once at the application's root. The `api` sub-directory holds the TypeScript client generated by `openapi-generator-cli`, ensuring type safety when communicating with the backend.
-   **Features**: Represents the different "pages" or business domains of the application. Each feature is a self-contained module, making the application easier to maintain and scale.
-   **Layout**: Defines the main structural components of the application's UI, such as headers, footers, and sidebars. This allows for consistent layouts across different feature modules.
-   **Shared**: A collection of reusable "dumb" components, pipes, and directives that are used across multiple feature modules. This promotes code reuse and a consistent look and feel.

## 🔗 API Endpoints Overview

The backend exposes a comprehensive RESTful API for interacting with the system.

| Endpoint | Method | Description | Authorization |
| :--- | :--- | :--- | :--- |
| `/api/auth/register` | `POST` | Registers a new user. | Permit All |
| `/api/auth/login` | `POST` | Authenticates a user and returns a JWT. | Permit All |
| `/api/breakdowns` | `GET` | Retrieves a paginated list of breakdowns. | Authenticated |
| `/api/breakdowns/report` | `POST` | Reports a new breakdown. | Permit All |
| `/api/breakdowns/{id}` | `GET` | Gets details of a specific breakdown. | Authenticated |
| `/api/breakdowns/{id}/close` | `PATCH` | Closes an open breakdown. | `TECHNICAN` |
| `/api/breakdowns/{id}/parts`| `POST` | Adds a spare part to a breakdown. | `SUBCONTRACTOR` |
| `/api/machines` | `GET` | Retrieves a paginated list of machines. | Authenticated |
| `/api/machines` | `POST` | Creates a new machine. | `ADMIN` |
| `/api/machines/{id}` | `PUT`/`DELETE` | Updates or deletes a machine. | `ADMIN` |
| `/api/employees` | `GET` | Retrieves a paginated list of employees. | Authenticated |
| `/api/employees` | `POST`/`PATCH` | Creates or updates an employee. | Authenticated |
| `/api/spare-parts` | `GET` | Retrieves a paginated list of spare parts. | Authenticated |
| `/api/spare-parts` | `POST` | Creates a new spare part. | `ADMIN` |
| `/api/spare-parts/{id}` | `PUT`/`DELETE` | Updates or deletes a spare part. | `ADMIN` |
| `/api/schedules/generate` | `POST` | Generates a new shift schedule. | Authenticated |

## 🚀 Getting Started

### 🛠 Prerequisites

-   ☕ **Java 17** or later
-   🌐 **Node.js 18.x** or later
-   🐳 **Docker** and **Docker Compose**
-   🛠 **Maven**
-   📂 **Git**

### 📥 Clone the Repository

```bash
git clone https://github.com/your-username/cmms-lite.git
cd cmms-lite
```

### 🐳 Running with Docker

1. Ensure Docker and Docker Compose are installed.
2. Build and run the application using Docker Compose:

```bash
docker-compose up --build
```

3. Access the application:
   - 🌐 **Frontend**: http://localhost:4200
   - 🔗 **Backend API**: http://localhost:8080
   - 📄 **API Documentation**: http://localhost:8080/swagger-ui-custom.html

### 🖥 Running Without Docker

#### Backend

1. Navigate to the backend directory: `cd backend`
2. Run the application: `./mvnw spring-boot:run`

#### Frontend

1. Navigate to the frontend directory: `cd frontend`
2. Install dependencies: `npm install`
3. Start the development server: `npm start`
4. Access at http://localhost:4200

### Frontend Scripts

- `npm start`: Runs the app in development mode.
- `npm run build`: Builds the app for production.
- `npm test`: Runs unit tests.
- `npm run api:generate:dev`: Generates the Angular API client from the local backend.
- `npm run api:generate:docker`: Generates the API client from the backend running in Docker.

## 📦 Dependencies

### Backend

- ☕ Spring Boot 3.5.4
- 🗄️ Spring Data JPA & Spring Security
- 🗄️ PostgreSQL & H2
- 🔑 JWT (io.jsonwebtoken) v0.12.6
- 🛠️ Lombok & MapStruct
- 📖 SpringDoc OpenAPI 2.8.9
- 🗃️ Flyway Core & 🎭 JavaFaker

### Frontend

- 🌐 Angular: ~20.2.1
- 🎨 Tailwind CSS: ~4.1.11
- 🍞 ngx-toastr: ~19.0.0
- 🗓️ FullCalendar: ~6.1.19
- 🖼️ ng-icons: ~32.1.0
- 🛠️ OpenAPI Generator CLI: ~2.21.4

## 🤝 Contributing

Contributions are welcome! Please fork the repository and create a pull request.

## 📜 License

This project is licensed under the MIT License. See the LICENSE file for details.