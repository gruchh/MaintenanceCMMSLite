<div class="mx-auto max-w-screen-xl p-4">
  <div class="bg-white dark:bg-gray-800 relative shadow-md sm:rounded-lg overflow-hidden">
    <div class="flex items-center justify-end p-4">
      <div class="w-full md:w-1/2">
        <form class="flex items-center">
          <label for="simple-search" class="sr-only">Szukaj</label>
          <div class="relative w-full">
            <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
              <svg aria-hidden="true" class="w-5 h-5 text-gray-500 dark:text-gray-400" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
              </svg>
            </div>
            <input
              type="text"
              id="simple-search"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              placeholder="Szukaj po nazwie lub producencie..."
              [formControl]="searchControl"
            />
          </div>
        </form>
      </div>
    </div>
    @if (isLoading()) {
      <div class="flex justify-center items-center p-8">
        <div class="text-lg text-gray-500 dark:text-gray-400">Ładowanie danych...</div>
      </div>
    } @else if (errorMessage()) {
        <div class="p-8 text-center text-red-600 dark:text-red-500">
            <p>{{ errorMessage() }}</p>
             <button (click)="fetchSpareParts(searchControl.value || '')" class="mt-4 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-500 dark:hover:bg-blue-600 dark:focus:ring-blue-800">
                Spróbuj ponownie
            </button>
        </div>
    } @else {
      @if (!isMobile()) {
        <div class="overflow-x-auto">
          <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
              <tr>
                <th scope="col" class="px-6 py-3">ID</th>
                <th scope="col" class="px-6 py-3">Nazwa części</th>
                <th scope="col" class="px-6 py-3">Cena</th>
                <th scope="col" class="px-6 py-3">Producent</th>
              </tr>
            </thead>
            <tbody>
              @for (sparePart of spareParts(); track sparePart.id) {
                <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                  <td class="px-6 py-4 font-medium text-gray-900 dark:text-white">#{{ sparePart.id }}</td>
                  <td class="px-6 py-4">{{ sparePart.name }}</td>
                  <td class="px-6 py-4">{{ sparePart.price | currency: 'PLN':'symbol':'1.2-2':'pl-PL' }}</td>
                  <td class="px-6 py-4">{{ sparePart.producer }}</td>
                </tr>
              } @empty {
                <tr>
                  <td [attr.colspan]="isAdmin ? 5 : 4" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">
                    Nie znaleziono części zamiennych.
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      } @else {
        <div class="p-4 grid gap-4">
          @for (sparePart of spareParts(); track sparePart.id) {
            <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow-md p-4 flex flex-col space-y-3">
              <div class="flex justify-between items-start border-b dark:border-gray-700 pb-2">
                 <span class="font-bold text-gray-900 dark:text-white">ID: #{{ sparePart.id }}</span>
                 <span class="text-lg font-semibold text-blue-600 dark:text-blue-400">
                    {{ sparePart.price | currency: 'PLN':'symbol':'1.2-2':'pl-PL' }}
                 </span>
              </div>
              <div class="space-y-1">
                <div class="text-sm text-gray-500 dark:text-gray-400">Nazwa części</div>
                <div class="text-base font-medium text-gray-900 dark:text-white">{{ sparePart.name }}</div>
              </div>
              <div class="space-y-1">
                 <div class="text-sm text-gray-500 dark:text-gray-400">Producent</div>
                 <div class="text-base text-gray-900 dark:text-white">{{ sparePart.producer }}</div>
              </div>
            </div>
          } @empty {
            <div class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">
              Nie znaleziono części zamiennych.
            </div>
          }
        </div>
      }
      <nav class="flex flex-col md:flex-row justify-between items-start md:items-center space-y-3 md:space-y-0 p-4" aria-label="Table navigation">
        <div class="flex items-center space-x-3">
          <label for="records-per-page" class="text-sm font-medium text-gray-900 dark:text-white">Rekordów na stronie:</label>
          <select id="records-per-page" (change)="onPageSizeChange($event)" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
            @for (size of pageSizes; track size) {
              <option [value]="size" [selected]="size === pageSize()">{{ size }}</option>
            }
          </select>
        </div>
        <span class="text-sm font-normal text-gray-500 dark:text-gray-400">
          Wyświetlanie
          <span class="font-semibold text-gray-900 dark:text-white">
            {{ totalElements() > 0 ? currentPage() * pageSize() + 1 : 0 }}-{{
              (currentPage() + 1) * pageSize() > totalElements()
                ? totalElements()
                : (currentPage() + 1) * pageSize()
            }}
          </span>
          z
          <span class="font-semibold text-gray-900 dark:text-white">{{ totalElements() }}</span>
        </span>
        <div class="inline-flex items-center -space-x-px">
          <button (click)="previousPage()" [disabled]="currentPage() === 0" class="flex items-center justify-center h-full py-1.5 px-3 ml-0 text-gray-500 bg-white rounded-l-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white disabled:opacity-50 disabled:cursor-not-allowed">
            Poprzednia
          </button>
          <button (click)="nextPage()" [disabled]="currentPage() >= totalPages() - 1" class="flex items-center justify-center h-full py-1.5 px-3 leading-tight text-gray-500 bg-white rounded-r-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white disabled:opacity-50 disabled:cursor-not-allowed">
            Następna
          </button>
        </div>
      </nav>
    }
  </div>
</div>
